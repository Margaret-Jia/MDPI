clc
close all
clear all

global A A0 N z a b cc1 cc2 cc3 d r tspan g t phii_d sum_dis xx0 yy0 zz0 vv0 thet0 phii0 D


ro = 0.1;%决定通信半径的取值范围
g = 9.8;
cc1 = 1;
cc2 = 1;
%case one
cc3 = 1; 
%case two
%cc3 = 0;
c = 1;
phii_d = 3.14/6; %phii 值可控

a = 1; %必须是稀疏矩阵才行 a要足够小
b = 1;
r = 0;
d = 4;
D=0.0025*d;

t0=0;
tspan=1; 
tf=100;
tt=t0:tspan:tf;

N_sample = 3;

for k=1:N_sample
    N=40*(2^(k-1));
    area = (N / (4 * ro))^(1/3);
%     xx0 = area * rand(N,1) - area * rand(N,1);
%     yy0 = area * rand(N,1) - area * rand(N,1);
%     zz0 = area * rand(N,1);
%     vv0 = 0.5 * rand(N,1); 
%     thet0 = pi/2 * rand(N,1) - pi/2 * rand(N,1); 
%     phii0 = pi/2 * rand(N,1) - pi/2 * rand(N,1); 
    if N==40
        %N=40 d=2.8 A0连通图
        xx0 = [2.10916286669929;2.27304544637061;-2.87525036158933;-2.25183235594707;-3.55601360183511;0.679134273561937;-2.50703571707010;1.16794623383515;-0.917343719619032;0.542514141540880;-1.09623339988814;1.10918897512777;-2.93794858818957;1.84332273313156;0.825679635230413;-2.25432305293206;-1.42695685450115;-1.00448102927563;-0.809493530330216;-1.70418974448238;-2.38051878477455;0.827298352119670;1.36490571049245;2.47309103027459;-2.40606727261799;1.70515861469435;-3.91697986274912;1.55011296149669;0.829693945426695;-1.64952854149703;-0.143888278579260;3.14402698536416;1.51292888852392;0.240777371190786;3.26032469306771;-2.67181588986742;-3.06775120843522;-0.587640578626512;-0.915317300176281;3.16300661714665];
        yy0 = [-0.586184128682721;-1.86541936453276;-0.360452360573925;2.71117631317891;-3.55447696664032;-1.09705072903542;2.10275301642034;-1.66402082736051;1.29393419485158;4.30951573431603;-3.39294888764997;-0.433164484956305;2.19331519763905;1.21388233262475;3.07636240860738;3.45275369448173;-0.0385210924888870;3.68513724704314;0.586938275419698;1.62506926775956;0.488157659990230;0.534465248915653;0.824707268947746;0.543283259998322;-1.38889065412916;2.43730040382442;-0.422045837319061;-3.01638257305916;1.60004746432840;2.44135257911617;0.356002167727718;0.132987814417143;3.11473335609402;1.92856532230480;0.232111750178205;-2.28107480004450;-1.91379136019416;2.70450425376117;0.247533736373925;2.57252864798834];
        zz0 = [0.501505277070896;2.13455358414930;2.09281235473032;2.55816682842339;3.73835568436785;3.25305787188048;4.04855857528310;0.242254511916203;1.01967032197247;2.13346922159225;4.44911883643511;3.66706570700338;2.09741613952481;1.54763654708852;0.274296143454718;3.43897778067537;2.35233180379212;0.927971565183050;1.98285681658313;0.782990914009905;3.48905721919824;1.70973315335611;4.37153096168325;0.0797078741359440;3.84813664862838;2.90837767259495;2.50063980890155;3.01938897655994;3.37271552332719;0.438577063197864;4.07333737415207;0.0666631669664270;1.36603178647240;0.835090891066081;4.29947713190713;0.316465554247205;2.69719583641634;2.95739399979581;3.02292414700816;4.01321987867155];
        vv0 = [0.0279762647035104;0.408427586886925;0.264461233164214;0.347175280311221;0.106202448140917;0.271639973124926;0.351260136076732;0.478217278630234;0.222271081436736;0.0426989154063225;0.0286700737706287;0.314725243049740;0.398089533249229;0.345595666429072;0.172653931107583;0.473408333580797;0.260095159105739;0.476906512598963;0.0367978179041000;0.103515974036537;0.387513906990984;0.457093910621887;0.391275323855150;0.147767098082438;0.0759228611572423;0.423955261156891;0.392427295546575;0.135415751075659;0.113905352408067;0.160511608544476;0.414780902199584;0.411091097300488;0.285341425240939;0.285914818114424;0.143009136249690;0.349566779650605;0.398128971640789;0.220794528075611;0.223107805845611;0.232831204182555];
        thet0 = [-0.0957353539003235;-0.269133394689801;1.03294774652043;0.513704821425832;-0.299205182138264;0.334146415068701;0.998492677253579;0.174692392826448;-0.876469293124999;-0.640453990099014;0.0497974872233954;-0.331754910268767;-0.855281159480586;1.18141586366576;1.02671017940527;1.24069449878999;-0.465352686256456;0.883548493057270;1.02455926483190;0.463192748091361;0.278632489279499;0.184733121332119;-1.03951256209488;-0.640095670744706;0.506555110970866;-0.237564001359759;-0.0270781979153033;-0.849586889496704;1.25380997271030;-0.0193823833875203;0.490643303361260;-0.104947789559226;-0.739411725173759;0.771932881130322;0.181777171142229;0.0652821748975523;-0.409747285900963;-0.356027195220035;-0.826309875646228;0.627297084730312];
        phii0 = [0.275395505468954;0.552366530791594;0.947497308687715;0.662793198147444;0.473232244733458;0.541120855245010;-0.0428828360222417;0.593669307919485;1.49869081075190;-0.0248937926941024;-0.472379695766616;0.0891749380081846;0.0413573758870949;-0.950836937807128;0.723523628677444;-0.990276818488010;-0.258529789924816;-0.187725608527560;0.572394087860563;0.229461642148537;0.614175874532954;0.0939361438845178;0.0402992917915934;-0.775589410855440;0.473312212184882;0.499369403233422;-0.107435716905743;0.0130576639350146;-0.655433756590534;0.378716062279825;1.38626241597686;0.340875208351055;0.271354666510921;-0.234399016403158;0.0437765840376223;-0.335760978298391;0.0464722099337462;-0.500650208135485;-0.334995574357380;-0.173852134869918];
    end
    if N==80
        %N=80 d=2.4 A0连通图
        xx0=[1.12551120646742;-0.508154046431740;-1.14516923571467;0.249623537551881;1.88261440960993;-1.88238367840946;-1.83302787008829;-0.290227780987326;-2.58968792026228;1.45167461515759;-5.67069531388048;-3.10327135867804;-1.39916331212685;-0.588681151549757;2.46313995338109;-4.23956707854702;3.07442472736913;-4.34007097036356;2.92537551133997;0.943239824003642;-4.09586472825415;2.97351924658117;-1.28474511261301;2.14067136568212;0.931818569866685;-2.25580111386507;1.60005462898022;-0.374643264822144;2.83853773173108;1.20380361533534;3.39214065171233;-4.50494711933664;-3.34150777148577;-2.24352470539479;-0.213830008275533;2.49694809897616;4.69310598668198;-0.673882196948356;4.47947191024802;-1.78944708612235;-0.0267564534584785;-1.84158050891753;-0.986929561230212;0.351712961739678;0.0257246740351436;-2.10392100054798;-0.505970630165171;-0.00768910772546683;-0.729364726156745;-0.877744848104256;-0.908216232189521;2.16702664357321;1.11141541788048;-0.0341912682471768;2.11045434999383;-1.89531900778418;-3.24754716501374;1.35588926303051;-0.683014775384369;1.62816348912744;-1.37300596093379;1.56380327384459;-1.90275644181126;0.914528266535196;-0.404424451997805;-0.0490320230627213;-0.0713103551418888;-3.65135391218854;-2.28103682122487;0.526409200230280;-2.71181647427277;1.42600566663821;-1.77994149546207;1.36677585203950;3.32477571724070;-0.390470064184540;-0.464215702658529;2.73058501138821;-1.18298114414299;4.79732827210791];
        yy0=[2.81663814319878;-2.84048409849439;1.17450514717767;1.35599161843358;-3.17394510054697;1.53401599417046;-0.715873136749418;-0.795150369625762;-4.29834239618540;-1.04748981741219;-0.213008097378379;-2.49828941086145;-3.52878928031838;-0.527211813560790;3.57070462824633;-4.03816676164106;1.54682359500954;0.723511163234500;-2.46205513818487;1.88549369813156;1.45927480040241;2.73115863127531;1.34905183076886;-3.28895211344336;1.76481320620947;-1.53394692612692;1.25738668240380;0.273729574347331;-1.48088579947869;1.49518545019194;-1.69334257384203;0.192564432727552;0.892874539217408;3.15005053890805;0.0686006849983566;2.21478919839480;1.68171672773652;3.26500547138848;0.283117826272000;-3.58583246371637;-0.246179192412862;-2.91353832809226;-3.57759530065809;-0.280014018226381;0.173972929163611;-4.36405455668972;1.59229880323886;-0.431205910694573;0.813971205574071;-1.57536371433451;2.26546355769933;0.269919914944623;-2.27820644451336;0.163460026081662;-2.47867511739191;2.34473735425412;-0.541681983429344;-2.21364692545705;4.47346849099301;1.86844399226566;0.518470063113782;2.08859494608640;-3.23576315695046;3.23664870027323;-3.18244625838740;-2.21283245466582;2.53745589171632;-2.73192018192518;-0.767446020225986;-2.59180546040459;2.56436176966129;-0.521483557351047;1.86500950962668;-0.706103919095932;-0.890376856931894;4.45972748703039;-2.18107986370753;2.47710512585889;-0.577691743310816;3.18940184257444];
        zz0=[2.84974005756136;4.70623876570786;5.63624533405546;4.44929249415455;2.03688506096209;4.08726325270955;3.59963861349709;1.22295143535439;5.20011517906808;4.10957263319546;2.74628187332643;4.16406927325697;1.91264152188954;0.294637582111933;2.34501920302836;2.35638396583226;1.51788410510576;0.353116177806452;5.70948261759324;3.05321752558054;1.72824038887454;5.02838905222554;4.02564094784058;5.72255376399171;3.48273187451464;2.03437052198809;5.11739566787959;5.36587181907945;3.64632095375345;5.09534663541287;1.07111773884850;3.06313777533504;5.54586044349739;0.210124281648232;4.36165151720045;3.59922135721062;0.485497556929340;2.56779912495105;1.65329102992711;3.68440364488434;4.65633831777805;3.02187928916395;3.77819559270417;1.81713281533778;2.98082068041072;2.23291873304230;1.76287931333384;0.603882885680593;5.39937705448723;3.88758697869865;4.42073019451814;1.39337273591117;1.47816661454599;0.704410082355165;5.51848801011119;4.54225675472422;4.68372513784231;2.63128175135817;4.20268383001927;3.25439419692235;4.94494780533419;2.40977134438939;3.54112725174045;4.18057386432801;4.39036528804778;2.45746090627457;4.83707312204616;5.08404316440480;5.75507801045030;1.94278234174793;5.06798923855320;2.79431634556819;1.93603049895459;4.40927225683101;5.23558701335056;0.135567827986054;2.33828833686299;3.60081384868261;1.93800210567968;0.208160892173357];
        vv0=[0.315609630508499;0.207450090023142;0.295289924040531;0.438742038283872;0.430468094167833;0.355290035214127;0.157225351853727;0.302564144015472;0.0124878184951469;0.231722754649130;0.0249791201546122;0.210323839308459;0.441233981113717;0.262482361052905;0.202150499327676;0.483536244027374;0.438819967288507;0.215835307696674;0.0350654610323540;0.354036392174980;0.439718256039889;0.00950232162471992;0.456926947869187;0.305611718241807;0.189950454198047;0.170786803362566;0.464204895736394;0.0961598033478038;0.244396810156061;0.457502575945782;0.0877395364767529;0.152852660141864;0.320773337636432;0.280316239268152;0.0302477643620164;0.0355743250636634;0.355238758817636;0.322960117739117;0.209996166027431;0.282850537410899;0.0305215122795398;0.453792045685741;0.211056878273249;0.0813028954771358;0.200257196044161;0.417085823434452;0.393822887687525;0.450219037376745;0.285650384049291;0.117454202038144;0.465827406811591;0.0190960895375361;0.323560607587625;0.0862325707924846;0.385985767804430;0.382055885801702;0.480933829620658;0.428682158759011;0.0656684657506658;0.206064477269662;0.244092584546974;0.421604765731669;0.372015054303587;0.422568506502693;0.372202859297909;0.307770847951792;0.212398849814506;0.416155341573450;0.160211728628613;0.336536543632069;0.379832844576583;0.306031345303754;0.128078553253985;0.00881850795667244;0.457080115275223;0.250294573546989;0.0349963818375879;0.365530975274616;0.243253106266125;0.0943545715963438];
        thet0=[-0.00782689128885550;-0.149107737584034;-0.199292271559810;-0.305284770950581;-0.452312300458360;-0.276322757135682;-0.128600023932745;-0.642488021387958;-0.542604163325532;1.21764975981820;1.14073024536130;1.13740779149463;0.121344172905978;-0.128282279148735;0.971868633415512;-0.440471114563676;-1.01149377076459;1.19430843310783;-0.545943414012338;0.325079249395011;0.880078718070468;0.427111712399590;0.919909648249640;-0.435891968458583;0.372261582701720;1.06610440044940;-0.458205952435445;-0.273319091378503;-1.37016895654283;-0.473480373957397;-0.664987145121933;-1.02344882326490;-0.357140774902879;1.09095637580379;0.894684244868518;-0.150665216840833;0.251174509164450;0.741793987349084;0.416970283001405;-0.361994697368334;0.545641229771672;-0.458773715439615;-0.0387418339206429;-0.948720101122873;0.237528841630513;-0.367632113148062;0.985623319810124;-0.856894277614868;0.876053536298100;0.680461692227169;0.595774367347961;0.723054016768885;1.28816007955351;-0.351024250592825;0.654419391712087;-0.917070155558074;-0.340192772766837;-1.53947892351758;-0.888826333967518;-1.09962402665367;0.810959194120527;-1.04477618331874;0.961272922122195;-0.639973020255819;-0.698734673108692;-0.0620388200261814;-0.790718328059773;-0.629717113498257;0.715689421891773;0.256347676668384;0.00894448733850584;0.635335997012390;-0.812253219309794;-0.688322481477280;0.128667177200255;-0.219309831160869;-0.413697931952496;-0.338568210727711;0.884919166324519;-0.0180983423164489];
        phii0=[-0.891129743998688;-0.375753853951261;-0.303664871899781;1.26322634343440;0.784460827313051;-0.666323293440045;0.593315833615519;0.0392520912159980;-0.0248095897935388;-0.607652169976962;-0.502500176228160;0.159939821875588;-0.420602638362515;-0.297642154674868;-1.11588666089553;-1.12316806520572;0.584175185177527;0.118204332450100;0.486517641198398;-1.32274222451179;1.33802705818157;-0.513766681214148;-0.173742243529136;-1.12709859683537;-0.577233257034274;-0.187040560796394;-1.06550262310890;-0.318658783443616;0.728857381503413;-0.850430400200393;-0.601654618044993;0.709253531387770;0.769741412519767;0.668582934366341;-0.733315074041092;-0.0230765093353673;0.164211695339477;-1.06917529544003;0.0103941491207695;-0.563307743831225;-0.256765529372583;1.26820891212884;-0.907223647290495;-0.978201167736581;0.866483192699152;0.210148156354803;-0.216738506664302;-0.0705272134401362;0.241631368605698;-0.751948789791895;-0.795210364128661;-0.0189039954644072;0.980991728874171;0.882999769396780;-0.507096684306744;-1.42438365488476;0.191008232594820;-0.733623027815749;0.197065142480219;-0.106788892766629;-1.22231312743053;1.06349834819803;-0.519387067564524;-0.146207886451553;0.556787057482154;0.794689379828564;-0.985791141430003;0.767021927010530;-0.0207598377605160;-1.22640538900408;0.817604701442320;-0.472797081658562;0.815556128500038;0.215033289318279;-0.478495177187891;-1.04574974879562;0.594341632264907;-0.195594878007718;0.135026947021974;-0.0275643802486349];
    end 
    if N==160
        %N=160 d=2.8 A0连通图
        xx0=[-2.14228752043468;-2.99785276198633;0.404101049551277;-1.17468700082349;0.268746003455216;2.88731885861831;-3.76253292708778;-0.170889519859789;1.25717598447390;0.499796513265049;2.50336826120224;3.52581081292890;-0.646515545642888;2.35449408929752;-2.42940336510151;3.04443206971767;5.45930468126418;-1.49853055339766;3.17450184717319;-1.86170469398770;-3.37139130929855;-1.63353507021345;-3.85412775977684;-0.516324994617560;3.52468163847273;-1.91034979926873;-0.817062528599710;3.68304263651025;-0.724248016382271;0.654475860008587;2.32003899245239;-1.98242972772702;-0.856238118974126;2.46361605442201;1.75889873088113;0.0401784218756385;2.93903237287146;1.11853519032316;-1.74494157871915;3.06629466303310;-3.46455287739948;-2.72292261773722;-3.54954546736950;3.02605799315308;0.750693914028382;-2.30266303602046;-0.957866725551889;3.61626541772073;-2.99534623919408;-1.63288493848805;2.25254811872026;1.80271041503910;1.67073302666240;-0.901371102843404;3.02158646557444;2.38978770748200;1.84369709449703;-1.74578783079681;-3.00150459768427;-0.146502161625325;-0.436038985580548;-1.50757319603008;6.19747292826045;-0.126031833037939;-3.69610546833499;0.738311907947325;-2.58674973652108;3.56432347749918;-6.80841865077383;4.10590980695310;-0.486682340599248;-1.61128182771824;-1.68068482846855;-0.117995241705390;-4.50686110375548;5.03065719215821;2.53797843661794;-1.08328018239137;0.0695585077339729;-0.0559919330934662;0.199619525765176;-4.50281105255839;4.48347817666280;0.189216515322839;-2.90647620061398;3.43283256088956;-4.94014452173861;0.754837968322756;1.38083039721785;3.89024256542537;2.92483150856094;2.03289377584303;-0.257302324261808;-4.39104317729714;0.500807260713891;0.399218604237693;-0.945402032063277;-4.51125932671752;1.85297037225378;-4.81711665528452;5.47429762439167;-1.78856309046673;0.565192542732145;-3.37587964394897;-0.117521311757181;4.23617140060719;1.43639581818672;2.12087244283238;-5.58702058733274;-0.00629795630028429;-0.262257419117174;-1.80565128525319;4.49564767830230;0.996326875655229;-3.60884145777984;5.00368022109110;-2.39533550869493;0.460892737084613;-6.09499126214870;-1.60921293850789;5.23855344555233;3.59513651355299;1.48522416445882;-2.96012749456159;3.60733681992183;-0.493824985350926;-4.89533926843857;0.0326462886854553;2.64318792548436;-2.30683778674590;5.61839437118365;3.12369257622172;-3.78733385188831;-3.35589620926297;-1.09408545561004;0.454650285731068;-2.28061569074396;-0.576811821348602;-1.65133015715353;2.26815019549080;-1.28652105987396;-2.05686232907521;0.554810835215504;-0.0377727591226984;-3.49202329367530;-1.10555616509750;-1.77657208088372;0.504556194225152;0.343943758522086;0.637213552842932;1.82762524133943;-0.887977528229181;-1.35001220011460;1.37697788719773;-3.55350431204928;-2.91190326871010;-2.43020008093968;-1.79188618397999;0.308888374507948;0.683544324424304];
        yy0=[2.76146933275558;3.64895355052322;0.934391755376620;3.55670210563625;0.892582445504927;2.63785570319792;2.86547886718518;4.99770049747607;-2.02683216263126;2.29488062723237;3.25046530291784;3.35338938661563;4.53311169783522;-1.19444144663252;-0.750470922980179;0.0609816884094009;-1.20622345670634;2.22057734123688;1.01799862420410;5.05858398724614;-3.70321820414926;4.93173171744147;2.06435526538482;1.62929714839452;4.86702623886806;7.14747685287590;2.72621632219702;-0.218373106081694;3.58486761896740;-2.00744058673704;4.08301055557954;-1.83741734141992;-4.49180247123156;-2.48175682742576;-4.91831224905084;-3.84709584462787;0.382581943504591;3.66604900786666;4.18503303440409;-0.306075714546939;-3.16457886013426;5.47200458345547;1.29739697919096;0.439576339523810;2.81047805411835;-1.28310098679362;2.06121990993530;-1.09931277258791;0.241436809674970;-5.09593355807060;5.33445680166964;-0.838409532362828;3.23814052711194;0.162140981577048;-5.14987995628118;-4.53831453929701;3.09364240639011;6.53936379590763;0.512022343351361;0.141161156178360;5.17499292836928;-0.231917605963634;-3.64899337111776;3.00668825102785;3.88105916746160;3.28867889288809;-0.551050151507387;-0.834810898729828;4.47555306083835;0.187145639643449;5.83659719555092;1.86011059890352;-1.05274624406033;5.86290310022058;3.48756014906029;-3.59100320302492;4.05234524595962;6.21534931475158;0.601438977682266;2.92267236329575;0.372569426971834;-3.02035715040129;-2.69537051288900;-4.88818502888159;4.65244579728016;0.421254187128230;3.14286685568266;-1.93433134212107;1.98022593429587;2.42048716123605;0.553698714348289;-2.27902475178584;0.702630300875373;0.207052311049623;-5.99211316398361;-1.45115008301316;-2.77477823706193;-2.46451420013653;-0.556041714419276;2.81988034032303;3.24550985942658;-4.32362458721985;-1.43728981811249;-0.239224471882549;3.04200199619222;2.05885985906269;-3.51501393859493;0.987039554865034;3.47968608133376;0.587042963991088;0.668644292463102;2.16203741149115;1.57579063110411;0.232743487106860;-0.228794767688456;-0.136881013582338;2.41770335956683;0.202021674416822;1.86662557946440;2.23912948806922;-0.183834903983668;-1.89500615410127;-4.08464477944010;-5.80077401905334;-0.523743310092340;1.10433811867499;-1.86086792459629;0.730017251429609;5.36914628121209;-1.22702879762528;-2.29814053069295;-1.99001362023583;-1.38579813738058;-5.13439101747343;-3.98545158907192;-3.95291569192454;0.649102453307143;0.707153861033336;0.116053908300798;-5.83818828388364;0.643718680344941;-6.11763934589522;1.06176222239104;4.15446811535422;2.33434868947738;-3.29632102826109;3.07626209299399;-3.29090416024158;0.855880565256435;-1.40140863266371;-1.32535276549176;0.402268513659578;2.51821854493605;-2.94986455625065;1.39996507430142;-6.52233431548233;-4.64414695378520;-0.341296384238084;-4.13205933191621;1.34838987004497];
        zz0=[4.27811668175128;4.53694429995769;3.92371543802595;2.65051890656302;4.53718354451313;4.83781320856224;1.67401923960132;3.87537757738203;0.706552619122840;6.25799672199222;6.57175429372072;4.48877561224502;0.797708768397886;1.19121558186290;2.07514144362319;2.38455103750986;0.0732345298076588;1.15004739192344;0.664217524608342;1.56962259042768;2.17445788415255;4.07131080042054;1.50599818254511;3.15304753587895;4.71553246663612;3.13679653334815;6.77106414996150;4.40753044182637;0.0243931248474330;5.41020163640487;3.10206120218900;2.41403318185160;5.01558421388423;2.53257051665030;3.43773813519720;3.47574628802218;4.99628298339413;2.68755348454933;2.63524100138960;3.45027775367975;2.69870817926903;1.96029006760606;0.449866393018294;3.83799512847896;5.35310290238760;6.36011243351869;4.46018858823227;0.330156672271278;1.85869244047020;4.64564505669127;1.34962494817760;2.59614070139236;3.20749950368073;5.33619952709153;5.66652796406554;1.11834382834836;1.64362571388739;3.08727336992170;0.831447507164440;0.292391340914695;4.88929945781027;0.179849767767464;5.37531199953117;3.13947473580567;2.72149378195250;6.94362778062905;4.06374526943788;7.17914849714676;6.57264377707122;0.993851959855554;1.60353132750234;1.04912085693619;1.95343405123938;0.842498932640155;3.77596183164298;4.86929132444597;5.89998666242304;3.93813578694399;0.723985823340144;6.78536508122599;6.69475505492929;3.54015934000309;6.51011172054135;6.89098050469138;6.93961746119822;0.0357527914291126;4.33588227342442;6.34668268011863;4.63946424614076;0.724183392428088;3.92762118590137;4.17369699534730;3.10305060552880;5.56004950138514;7.17061823018639;1.92928709952418;5.43495077614807;6.01301514815366;1.79865151260051;6.33455999282361;5.14646298923178;2.97347187043623;3.15426447277904;0.259843510375596;4.41354884957027;6.37026222043604;6.35642147260308;4.55429087136371;3.29064088834435;4.80154509195804;4.69381450697412;7.26261223885684;7.16495229253297;3.24694164626383;4.93547195461285;4.11530502618558;0.615782178104620;6.77344041354733;4.81969732176251;4.94515913560344;3.39242561897481;4.82870743511825;2.73890818501927;6.53484709325504;2.86891735478293;6.33345215468595;5.72370782911213;1.26669741292812;6.29708363959123;5.25819886761846;4.46203474532206;3.47700215512678;2.66116593205844;2.91825711549361;1.18682751748782;5.38506784152308;4.38833059912595;1.24947522362224;3.50048252035517;6.70670115569541;1.86446203987944;1.42751299233629;5.50252854508869;3.68041122485286;1.49110077692519;6.32214842470475;2.95855740093922;0.980994735625752;4.92429408076269;6.18531651848829;1.44162039162640;3.12457531848948;6.71997431160817;3.72618782045563;1.97823746712963;2.53734911224608;6.62965929729752;3.67251150656636;3.29930970663959;0.00762354268623717];
        vv0=[0.251746259210586;0.206547647388897;0.297273148843319;0.251377548678838;0.187641202284622;0.496804644161338;0.0761824119553632;0.170631949934622;0.442628998834497;0.125227777452847;0.0680796108884041;0.265159397928958;0.00231149774392819;0.0537749031241915;0.181617363284119;0.277040054941777;0.208518780114295;0.142504067306327;0.0959716912511573;0.492312686196140;0.275840113330226;0.442228469983833;0.107740391047769;0.122630910495028;0.0916887335715244;0.00794998730929380;0.148292404023939;0.295399941735047;0.00284287071740769;0.244760766953947;0.257524494700332;0.184253176534386;0.226447982470821;0.377409606134762;0.496020963657205;0.485236386474332;0.258011440230050;0.106626577511298;0.478512219314877;0.147775215717725;0.198660352136399;0.340566124851415;0.276287323060280;0.0601898535967558;0.451602219200934;0.324765231958206;0.128741867012871;0.107741656484569;0.255854560051119;0.170435353178775;0.224139458384869;0.377757858046217;0.0394036197866997;0.323484092576766;0.422341461794416;0.157712381031131;0.0527843826831838;0.122530863067512;0.0473344300372863;0.0453043938512377;0.0537073892719033;0.477806916668383;0.0184533811812330;0.347158252219844;0.490196106604482;0.154454252138402;0.0686524688958192;0.128279434122935;0.497057682077455;0.251461564614443;0.231819723306602;0.135948063870813;0.0860473757450911;0.0805784088394220;0.0694862973284612;0.494564692320251;0.438021040893695;0.0620244299178323;0.0474142854224716;0.443918899254718;0.248799642469250;0.237827061773947;0.434338635837942;0.212019343739416;0.113595456294198;0.290089593590176;0.120143834788005;0.173893223060730;0.385513408438622;0.193024887004290;0.218638871415909;0.156361017749851;0.470706450562519;0.326929573356877;0.127780936225691;0.386355801738247;0.484405848062607;0.489344625069604;0.394935201971758;0.300454109784866;0.0380637199819017;0.0750164337797852;0.201430584559403;0.259373955129941;0.494221549516518;0.0700247405498512;0.324208552394577;0.0195357714409058;0.489977529352109;0.432558449927438;0.209280984378783;0.256790821166410;0.334266271772861;0.112977048888730;0.288113705189274;0.393154822871082;0.134847067250613;0.476211193242556;0.261923640117483;0.341992259136711;0.307963716874364;0.319193233355938;0.00723754367684387;0.0988653402248199;0.323533833499824;0.349798766442544;0.489197605036854;0.0139274894124059;0.360131853207963;0.166013414110249;0.292997268658455;0.406911859504165;0.409754376128031;0.146163877674819;0.0282169484742488;0.0420144412115191;0.367421494226642;0.439814637764046;0.318975190042388;0.238876309355596;0.228974692280431;0.165185012959575;0.0582766039702728;0.154509095001891;0.371459377887194;0.377005710662771;0.0908313580685670;0.149020953903173;0.368064909787500;0.230210329464241;0.282834003181209;0.0965523467610933;0.223624683092998;0.179720290072393;0.240483948428308;0.0147356823253372;0.0327417530898468;0.353677648967599;0.198338671854805;0.118934157824942];
        thet0=[-0.587448493065319;-0.351526211665988;-0.230609378932105;-0.0519341650741103;0.264193354603872;-0.105966513013645;1.01345966397198;0.394427804052285;-0.415346559735811;-0.618491637711489;-0.769971217448549;0.633729512983710;0.723558313653532;-0.730735443835826;0.558556739014299;0.380978934981581;-0.0546154133935493;1.03605891956823;0.896631219939440;0.586007680696051;0.0933040823553897;0.590580853565564;0.0480591287402093;-0.731776829356654;-0.115774917722585;0.644982044766671;-0.522037057436641;0.117409622176613;-0.633393085093087;1.35310374168761;-0.900012761697088;0.0834783538550923;0.699505973639674;-0.267403241978124;0.134104050278543;0.148402458223211;-0.843493489694321;-0.140296307907489;-0.258057891599240;0.703105488913952;-0.867425325247328;-0.869144039556030;-0.110530129427225;0.388881598945289;-0.335672996761612;1.05582502997914;0.115258589656117;0.835988798467636;-0.0986028819652112;0.381750581913525;-0.559341079374512;1.07003902156084;0.159045340757720;1.05257587718380;0.878550581024902;0.680814278569755;-0.732385736410082;-0.625215200252509;0.803339775712285;0.0716349652681081;0.0813841520856257;0.484039344326289;0.321963559856445;-0.687572498495705;-0.708850213693204;0.476223560853114;0.392562607691610;0.530918025323218;-0.581777138343563;-0.330897617566950;0.162359400457556;-0.486164593341649;-0.733075233014148;0.335111964064744;1.17596111547289;0.916061494780081;0.788486465025802;0.454014982803943;-1.33007768325724;1.15820297270335;-0.222840448536670;-0.606830635070873;1.32934720161711;0.0366365279367336;-0.459684711128593;-0.624845239220739;0.366660298464776;0.604313040774471;-0.0447382045941063;0.937154051718749;-0.807686016532274;0.457338763120043;0.915100944053335;0.123034660450554;0.0277645682156172;-0.751113044287759;0.390755398819192;0.343716353406332;0.631630801468859;0.173275406732372;1.03316371151185;0.0258051418123024;0.0656147875261444;-0.820873145211812;-0.667425871082086;0.308863186694370;1.18257686716752;-0.386715665623897;0.0116878632247652;0.437087782434898;-0.0966434114985471;-0.235057700399978;-0.552927405376940;-0.777305531426910;-0.391628576259719;-1.01822562398714;-0.820350223438414;0.994501434052023;0.661081216912819;-0.671155352559622;-0.165928484200808;-0.628451212041376;-0.242629599746422;0.949166987361279;-0.428449707917719;-0.707367763907562;-0.249187016402584;-0.827186969156768;0.241953809147961;-0.0752771482543047;-0.779607958497405;0.0499604363494861;0.299644675612687;-0.688609978731742;0.437474786030251;-0.496102192660841;-0.720686644259077;-0.147597130134434;0.741734455881206;-0.127629067704219;-0.0715760268684982;-1.30555951535138;1.17521591895477;-0.582402207663069;0.479086761513327;0.123886222296859;0.739107145813526;0.317174146077370;-1.05816804108575;-0.287659377815375;0.314542607714015;0.491088751301259;0.610637768847148;-1.06355616592692;1.26027162609958;0.653715034595944;-0.509306953326577;-0.850457477317721;-0.549354046874686;-0.849145729032287];
        phii0=[0.409984228312906;0.437153314021628;-0.177945192398191;0.276991129476794;-0.970315136649900;1.37297850649404;-0.472787816231444;0.863308754967888;-0.0271606419176522;0.257630129610777;-0.143171847628615;-0.140701928101751;-0.491005162617912;-0.785375750953104;-1.22160958841453;0.0446927131921886;-0.986418900753429;-1.20005402615851;-0.180508949328288;-0.00978021307444921;0.383478106928002;-0.741249833812521;-0.536114905532529;0.778424009857407;0.339562503007072;-1.07287071878039;0.162406398368852;-0.132446536997319;0.654253125447746;-0.410393381187729;0.366491629299703;-0.762907076490519;0.0160642022704363;0.127004090302601;0.952515844818063;-0.953864473294027;0.158256999121129;0.303246617754683;-0.143755171244855;-0.143571597768957;0.804809413252949;-0.0230742706819616;0.113579082738256;-0.854907451360155;0.345731304532539;0.857566523910759;0.000928440468029868;0.145877991127042;-0.861209694383671;-0.510535696871281;0.294530998939822;0.366234178990404;-0.594889748979111;-0.0110995636731538;0.499612817143835;0.965697484632255;0.0514144682817703;0.284689233493046;-1.18623586214457;1.01402353299335;-0.846727014478465;0.981201465933335;-1.07422892352927;0.00207799533720721;-0.174741861032178;-0.244634355598597;0.932165954765105;0.869385578835374;0.786016288694663;-0.590876657880306;0.159498525636449;1.21524529968363;-0.399647256909451;-0.773710693056237;-0.298832637837480;0.915151279386056;-0.110285961652094;0.235579115589795;0.308754931037215;-0.946148007847414;0.131398163120643;-0.139346361451695;1.37249754587464;0.676616408530016;1.15927092363334;-0.806026113897047;0.300189442031813;-1.09754415478042;1.11483214812080;0.268339878273011;-1.27531428966855;0.926454014769273;-0.336156720443495;-0.230823867691178;-0.162935570184006;-0.817297193787768;-0.149392732541120;-0.359086239066715;-0.320116000075781;0.376607659048310;-0.590093135407416;-0.391666390981226;-0.837024542099578;0.986296565317218;1.51021889954765;0.0382905578721983;-1.19724389593702;0.00885589476937243;-0.741414155037204;1.23899982674802;-0.278983856713999;-0.542712136037744;0.0607938033708042;-0.0566043079081353;-0.178929740068033;0.175333458118276;0.685338918650110;0.190540187171991;1.33014042666904;0.692641303442418;-1.22817255486049;0.301051880395908;-0.0171101481499952;0.0361492699504739;-0.228622528452243;-0.491196138429043;-0.264367788320198;0.559056430285191;0.945981060898194;0.935906031925160;0.210372565780957;1.34647956991201;0.839471128460672;-0.0344684389613276;0.0782078541673821;-0.311943986735497;-0.0364217101574828;-0.182592759093322;-0.245417894611916;0.195174681648391;0.00139302786232004;-0.243544257737822;0.0476421216002012;-0.0104016628263550;-0.471501065493477;0.0165515792941054;0.530888981949057;-0.503941913286164;-0.167424685239260;0.611883012398187;-0.571300239455068;0.414649546682406;0.122022430653084;0.163895590595905;-0.182280054252713;-0.342382490237118;0.716085445197101;0.0947324529912472;0.276538530868846;-1.02361963253302];
    end
    z0=[xx0' yy0' zz0' vv0' thet0' phii0']';
    for i=1:N
        for j=1:N
            if i==j
                A0(i,j)=0;
            else
                if (xx0(i)-xx0(j))^2+(yy0(i)-yy0(j))^2+(zz0(i)-zz0(j))^2 < d^2
                    A0(i,j)=1;
                else
                    A0(i,j)=0;
                end
            end
        end
    end
    A=A0;
    [t,z]=ode113('F_rendezvous33',tt,z0);
    zzz=zeros((tf+1),N*(N-1)/2);
    for i=1:(N-1)
        for j=(i+1):N
            m=(i-1)*N-i*(i+1)/2+j;
            zzz(:,m)=sqrt((z(:,i)-z(:,j)).^2+(z(:,(i+N))-z(:,(j+N))).^2+(z(:,(i+2*N))-z(:,(j+2*N))).^2);
        end
    end
    sum_dis(1:(tf+1),k)=sum(zzz,2);       
end

dc=hsv(N_sample);           % colours are generated; start from red
figure
hold on
i=1;
DD=[2^0,2^1,2^2].*40;
for d=1:N_sample
    plot(t,sum_dis(:,d),'color',dc(i,:),'LineWidth',1.5); 
    set(gca,'fontsize',12,'FontWeight','bold','fontname','Times'); %依次设置坐标轴的属性分别为：线宽（4），刻度字号大小（30），刻度字体（罗马体）。
    leg_str{i}=['N=',num2str(DD(i))];
    i=i+1;
    hold on
end
legend(leg_str)
xlabel('time t (s)'); 
ylabel('the sum of distances between any two UAVs (m)');
grid on; 
